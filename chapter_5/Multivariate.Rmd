---
title: "Multivariate"
author: "Alexis"
date: "10/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
```

```{r}
library("dplyr")
library("tidyr")
library("tidyverse")
library("ggplot2")

```


Importing and subsetting datafile
```{r}
dat <- data.frame(read.csv('datafile.csv'))
dat$AdoptionSpeed <- factor(dat$AdoptionSpeed, order=T, levels = c(0,1,2,3,4))

dat$Type = as.factor(dat$Type)
dat$Name = as.factor(dat$Name)
dat$Breed1 = as.factor(dat$Breed1)
dat$Breed2 = as.factor(dat$Breed2)
dat$Gender = as.factor(dat$Gender)
dat$Color1 = as.factor(dat$Color1)
dat$Color2 = as.factor(dat$Color2)
dat$Color3 = as.factor(dat$Color3)
dat$MaturitySize = as.factor(dat$MaturitySize)
dat$FurLength = as.factor(dat$FurLength)
dat$Vaccinated = as.factor(dat$Vaccinated)
dat$Dewormed = as.factor(dat$Dewormed)
dat$Sterilized = as.factor(dat$Sterilized)
dat$Health = as.factor(dat$Health)
dat$State = as.factor(dat$State)
```

Dropping less useful values in categorical variables:
MaturitySize: dropping 0 = Not Specified
FurLength: dropping 0 = Not Specified
Health: dropping 0 = Not Specified

```{r}
dat = subset(dat, dat$Quantity == 1)
dat = subset(dat, ! dat$AdoptionSpeed == 4)
dat = subset(dat, ! dat$MaturitySize == 0)
dat = subset(dat, select = - c(Health, State, Sterilized, Quantity, Dewormed, Color1, Color2, Color3, Breed1, Breed2, Fee, RescuerID, Name, Description, PetID))
summary(dat)
```

Creating Randomized Dependent Variable

```{r}
# Adding random values
dat$ASnum = NaN
dat$ASnum[dat$AdoptionSpeed == 0] = 0
dat$ASnum[dat$AdoptionSpeed == 1] = runif(sum(dat$AdoptionSpeed == 1), 1, 7)
dat$ASnum[dat$AdoptionSpeed == 2] = runif(sum(dat$AdoptionSpeed == 2), 8, 30)
dat$ASnum[dat$AdoptionSpeed == 3] = runif(sum(dat$AdoptionSpeed == 3), 31, 90)
dat$ASnum[dat$AdoptionSpeed == 4] = 100

str(dat)
```

### SMART Question 3: What numerical variables influence adoption speed?
- Making linear models for each numerical variable

Age

```{r}
lm_age <- lm(ASnum ~ Age, data=dat )
summary(lm_age)
```
Statistically significant p-value, R-squared remains very low, Age alone does not predicate adoption speed.

Video Amount
```{r}
lm_video <- lm(ASnum ~ VideoAmt, data=dat)
summary(lm_video)
```
Not statistically significant, p-value > alpha. 

Photo Amount
```{r}
lm_photo <- lm(ASnum ~ PhotoAmt, data=dat)
summary(lm_photo)
```


#SMART Question 4:
What combination of categorical and numerical variables result in the best predictive model?

First, lets look at the correlation plot of all numeric variables:

```{r}
library("corrplot")
dat_numerical <- subset(dat, select = c('ASnum','Age','PhotoAmt','VideoAmt'))
num_corr <- cor(dat_numerical)
corrplot(num_corr, method = "number", type="upper")
```

- Super ugly corrplot, alternative might be better

