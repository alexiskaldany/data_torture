---
title: "Hypo_tests_midterm"
author: "Sahara Ensley"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
library(ezids)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```
AdoptionSpeed - Categorical speed of adoption. Lower is faster. This is the value to predict. See below section for more info.
Type - Type of animal (1 = Dog, 2 = Cat)
Age - Age of pet when listed, in months
Gender - Gender of pet (1 = Male, 2 = Female, 3 = Mixed, if profile represents group of pets)
MaturitySize - Size at maturity (1 = Small, 2 = Medium, 3 = Large, 4 = Extra Large, 0 = Not Specified)
FurLength - Fur length (1 = Short, 2 = Medium, 3 = Long, 0 = Not Specified)
Vaccinated - Pet has been vaccinated (1 = Yes, 2 = No, 3 = Not Sure)
PhotoAmt - Total uploaded photos for this pet
## Intro
```{r}
## Loading data
data = read.csv('chapter_5/datafile.csv')
data$AdoptionSpeed <- factor(data$AdoptionSpeed, order=T, levels = c(0,1,2,3,4))

# converting the data types we want
data$Type = as.factor(data$Type)
data$MaturitySize = as.factor(data$MaturitySize)
data$FurLength = as.factor(data$FurLength)
data$Vaccinated = as.factor(data$Vaccinated)
data$Gender = as.factor(data$Gender)

# Only looking at profiles with 1 animal
data = subset(data, data$Quantity == 1)
data = subset(data, ! data$AdoptionSpeed == 4)

# Only pulling the columns we want to look at
dat = data[c('Type', 'Age', 'Gender', 'MaturitySize', 'FurLength', 'Vaccinated', 'PhotoAmt', 'AdoptionSpeed')]
summary(dat)

# Adding random values
dat$ASnum = NaN
dat$ASnum[dat$AdoptionSpeed == 0] = 0
dat$ASnum[dat$AdoptionSpeed == 1] = floor(runif(sum(dat$AdoptionSpeed == 1), 1, 8))
dat$ASnum[dat$AdoptionSpeed == 2] = floor(runif(sum(dat$AdoptionSpeed == 2), 8, 31))
dat$ASnum[dat$AdoptionSpeed == 3] = floor(runif(sum(dat$AdoptionSpeed == 3), 31, 91))
#dat$ASnum[dat$AdoptionSpeed == 4] = 100

summary(dat)
```

## Chapter 2

## Chapter 3

## Chapter 4

### SMART: Do dogs get adopted faster than cats?

In order to answer this question, we split the data into two groups, dogs and cats. Because there were only 2 samples we decided to use a two-sample t-test to evaluate if there was a significant difference between the average adoption speed between dogs and cats. 
```{r}
library('ggplot2')
library('lmtest')
#pdf('type_boxplot.pdf')
ggplot(data = dat, aes(y = ASnum, x = Type, fill = Type)) + 
  geom_boxplot() +
  labs(title = "Adoption Speed by Animal Type", x = 'Animal Type', y = 'Adoption Speed') + 
  scale_x_discrete(labels=c("1" = "Dog", "2" = "Cat")) + 
  scale_fill_discrete(labels = c("Dog", "Cat"))

#dev.off()
```

```{r, results='markup'}
bp_dogscats = bptest(data = dat, formula = ASnum ~ Type)
bp_dogscats
dogs = subset(dat, dat$Type == 1)
cats = subset(dat, dat$Type == 2)

dc_t = t.test(dogs$ASnum, cats$ASnum)
dc_t
```

The first thing we had to do was a check of the homogeneity of variance. To do this we did a Breusch-Pagan (BP) test. The null hypothesis for this test is that the two groups have the same variance, while the alternative hypothesis is that the groups have difference variances. Because the p_value is less than our alpha of 0.05 we have to reject the null hypothesis that the groups have the same variance. Because of this, the two-sample t-test is not technically a valid statistical test, however we went ahead and performed the test regardless. The p_value of the t-test was also less than our alpha of 0.05, allowing us to reject our null hypothesis that there is no difference between the means of the two groups. Becuase of this we can conclude that there is a difference in adoption speed between cats and dogs. The mean of the dogs adoption speed is --- and the mean of the cats adoption speed is ---, so we can conclude that dogs get adopted slower than cats.

### SMART: Do physical attributes affect adoption speed?

The next question we wanted to answer was whether physical attributes affect adoption speed. To answer this question we looked at the sex of the animal, the size, the fur length, and the vaccination status.

```{r, results='markup'}
### GENDER
#pdf('Gender_boxplot.pdf')
bp_mf = bptest(data = dat, formula = ASnum ~ Gender)
bp_mf
male = subset(dat, dat$Gender == 1)
female = subset(dat, dat$Gender == 2)
mf_t = t.test(male$ASnum, female$ASnum)
mf_t


ggplot(data = dat, aes(y = ASnum, x = Gender, fill = Gender)) + 
  geom_boxplot() + 
  labs(title = "Adoption Speed by Animal Gender", x = 'Animal Gender', y = 'Adoption Speed') + 
  scale_x_discrete(labels=c("1" = "Male", "2" = "Female")) + 
  scale_fill_discrete(labels = c("Male", "Female"))
#dev.off()
```

Again, the BP test of variance had a p_value that was significant for our alpha of 0.05, so we were able to accept the alternate hypothesis that the variance was not equal between the groups. We went ahead and did a two-sample t-test regardless and found that this was also significant. So we can reject the null hypothesis that the mean adoption speed between male and female dogs is the same. 

```{r, results='markup'}
### SIZE
bp_size = bptest(data = dat, formula = ASnum ~ MaturitySize)
bp_size
#pdf('Size_boxplot.pdf')
ggplot(data = dat, aes(y = ASnum, x = MaturitySize, fill = MaturitySize)) + 
  geom_boxplot() + 
  labs(title = "Adoption Speed by Maturity Size", x = 'Maturity Size', y = 'Adoption Speed') + 
  scale_x_discrete(labels=c("1" = "Small", "2" = "Medium", "3" = "Large", "4" = "Extra Large")) + 
  scale_fill_discrete(labels = c("Small", "Medium", "Large", "Extra Large"))
#dev.off()
anova_size = anova(aov(data = dat, ASnum ~ MaturitySize))
anova_size
turkey_size = TukeyHSD(aov(data = dat, ASnum ~ MaturitySize))
turkey_size
```

Looking at size we have over 2 samples, so we chose to run an ANOVA to test if the mean adoption speed differed between different sized animals. Once again, we ran a BP test of variance that produced a significant p_value, so an ANOVA is technically not appropriate, however we did run the analysis regardless. We ended up with a significant p_value for the anova so we ran a TukeyHSD post-hoc test and found that ----

```{r, results='markup'}
### FURLENGTH
bp_fur = bptest(data = dat, formula = ASnum ~ FurLength)
bp_fur

#pdf('fur_boxplot.pdf')
ggplot(data = dat, aes(y = ASnum, x = FurLength, fill = FurLength)) + 
  geom_boxplot() +
  labs(title = "Adoption Speed by Fur Length", x = 'Fur Length', y = 'Adoption Speed') + 
  scale_x_discrete(labels=c("1" = "Short", "2" = "Medium", "3" = "Long")) + 
  scale_fill_discrete(labels = c("Short", "Medium", "Long"))
#dev.off()
anova_fur = anova(aov(data = dat, ASnum ~ FurLength))
anova_fur
turkey_fur = TukeyHSD(aov(data = dat, ASnum ~ FurLength))
turkey_fur
```


```{r, results='markup'}
### VACCINATED
bp_vac = bptest(data = dat, formula = ASnum ~ Vaccinated)
bp_vac
#pdf('vacc_boxplot.pdf')
ggplot(data = dat, aes(y = ASnum, x = Vaccinated, fill = Vaccinated)) + 
  geom_boxplot() + 
  labs(title = "Adoption Speed by Vaccination Status", x = 'Vaccination Status', y = 'Adoption Speed') + 
  scale_x_discrete(labels=c("1" = "Vaccinated", "2" = "Unvaccinated", "3" = "Not Specified")) + 
  scale_fill_discrete(labels = c("Vaccinated", "Unvaccinated", "Not Specified"))
#dev.off()
anova_vac = anova(aov(data = dat, ASnum ~ Vaccinated))
anova_vac
turkey_vac = TukeyHSD(aov(data = dat, ASnum ~ Vaccinated))
turkey_vac
```

